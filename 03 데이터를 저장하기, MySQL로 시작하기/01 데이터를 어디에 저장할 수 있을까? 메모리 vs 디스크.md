# 데이터를 어디에 저장할 수 있을까? 메모리 vs 디스크



## 1. 데이터 저장의 필요성

트위터 애플리케이션을 생각봅시다. 서비스를 사용하려면 먼저 회원가입을 해야겠죠? 이 때 우리의 정보는 서버에 저장이 되어야 합니다. 예를 들어 우리 닉네임이 저장되어야 다음에 들어올 때 동일한 이름의 닉네임을 사용할 수 있으니까요. 이렇듯이 웹 애플리케이션에서 데이터를 저장하는 것은 매우 중요합니다. 사용자가 입력한 정보 외에도 시스템이 생성한 데이터, 그리고 애플리케이션의 상태 정보 등 다양한 데이터를 저장하고 관리해야 합니다. 이러한 데이터를 저장하는 방법에는 크게 두 가지가 있습니다: **메모리**와 **디스크**입니다.



## 2. 메모리 저장 (In-Memory Storage)

### 메모리 저장이란?

메모리 저장은 데이터를 컴퓨터의 RAM(Random Access Memory)에 저장하는 방식입니다. 이 방식은 데이터를 빠르게 읽고 쓸 수 있지만, 전원이 꺼지면 데이터가 사라집니다. 즉 서버에 배포가 필요해서 재시작 된다거나, 예기치 못한 장애를 맞아 종료될 때 메모리에 저장된 데이터는 사라집니다.
장단점을 한 번 알아보겠습니다.

### 메모리 저장의 장점

**빠른 접근 속도**: 메모리는 디스크보다 훨씬 빠르게 데이터에 접근할 수 있습니다.

**간단한 구현**: 복잡한 설정 없이 바로 사용할 수 있습니다.

**임시 데이터 저장에 적합**: 세션 정보, 캐시 데이터 등 임시로 필요한 데이터를 저장하기에 좋습니다.

### 메모리 저장의 단점

**휘발성**: 전원이 꺼지면 **데이터가 사라집니다.** 데이터가 사라지면 큰일나는 곳엔 사용하면 안됩니다.

**용량 제한**: 메모리의 용량은 디스크보다 제한적입니다. 
예를 들어 시중에 있는 MacBook Air 13인치 모델을 찾아보았습니다. 이 컴퓨터는 8GB RAM 을 가졌네요. 여기서 서버를 작동시켜서 이 이상으로 메모리에 데이터를 저장하면 "메모리 부족(Out Of Memory)" 에러가 발생하게 될거예요. 대안은 속도는 조금 느리지만 메모리 대신 256GB SSD 디스크에 데이터를 저장하는 방법이 있습니다.

**비용**: 보통 대용량 메모리는 디스크보다 비용이 많이 듭니다.

### Spring Boot에서의 메모리 저장 예시

```java
@Service
public class InMemoryUserService {
    
    // 메모리에 사용자 정보를 저장하는 맵
    private final Map<Long, User> users = new HashMap<>();
    private Long nextId = 1L;
    
    public User save(User user) {
        user.setId(nextId);
        users.put(user.getId(), user);
        nextId += 1;
        return user;
    }
    
    public User findById(Long id) {
        return users.get(id);
    }
    
    public List<User> findAll() {
        return new ArrayList<>(users.values());
    }
    
    public void delete(Long id) {
        users.remove(id);
    }
}
```



## 3. 디스크 저장 (Persistent Storage)

### 디스크 저장이란?

디스크 저장은 데이터를 하드 디스크, SSD 등의 영구 저장소에 저장하는 방식입니다. 이 방식은 전원이 꺼져도 데이터가 유지됩니다.

### 디스크 저장의 장점

**영구성**: 전원이 꺼져도 데이터가 유지됩니다.

**대용량 저장**: 디스크는 메모리보다 훨씬 큰 용량을 제공합니다.

**비용 효율성**: 대용량 저장에 비용이 효율적입니다.

### 디스크 저장의 단점

**느린 접근 속도**: 메모리보다 데이터 접근 속도가 느립니다. 백엔드 개발자는 데이터가 느리게 조회되는 부분이 API 응답의 병목이 됨을 인지하여 개선할 줄 아는 능력이 필요합니다.

**복잡한 구현**: 데이터베이스 설정, 연결 관리 등 추가적인 작업이 필요합니다. 스프링부트 애플리케이션과 MySQL 을 연결하는 과정이 처음에 조금 복잡할 수 있어요.

**백업 및 복구 필요**: 데이터 손실을 방지하기 위한 백업 및 복구 전략이 필요합니다. 이 부분은 조금 심화적인 내용이니 본 자료에서는 다루지 않습니다. 

### 디스크 저장의 종류

**파일 시스템**: 텍스트 파일, CSV, JSON 등의 파일 형식으로 데이터를 저장합니다. 우리가 생각할 수 있는 가장 간단한 방법이기도 합니다.

**관계형 데이터베이스(RDBMS)**: MySQL, PostgreSQL, Oracle, SQL Server 등에 저장할 수 있습니다.

**NoSQL 데이터베이스**: MongoDB, Cassandra, Redis, Elasticsearch 등 데이터가 읽고 쓰여지는 양과 속도에 따라 다른 데이터베이스를 고를 수도 있습니다.



## 4. 정리) 메모리 vs 디스크 중 어떤 것을 선택해야 할까?

### 메모리 저장이 적합한 경우

**임시 데이터**: 세션 정보, 캐시 데이터 등 임시로 필요한 데이터

**빠른 접근이 필요한 경우**: 실시간 데이터 처리, 고성능 요구사항

**데이터 손실이 허용되는 경우**: 중요하지 않은 데이터

### 디스크 저장이 적합한 경우

**영구 데이터**: 사용자 정보, 주문 내역, 상품 정보 등 영구적으로 저장해야 하는 데이터

**대용량 데이터**: 많은 양의 데이터를 저장해야 하는 경우

**데이터 일관성이 중요한 경우**: 트랜잭션 처리, 데이터 무결성 보장이 필요한 경우



## 5. Spring Boot에서의 데이터 저장 전략

### 메모리를 사용하고 싶을 때

**인메모리 저장소**: 간단한 테스트나 프로토타입 개발에 사용합니다.

**H2 데이터베이스**: 인메모리 또는 파일 기반의 경량 데이터베이스로, 개발 및 테스트에 적합합니다.

### 디스크를 사용하고 싶을 때

**관계형 데이터베이스**: MySQL, PostgreSQL, Oracle 등

**NoSQL 데이터베이스**: MongoDB, Cassandra 등

**분산 캐시**: Redis, Memcached 등 (메모리 기반이지만 영구성을 제공하는 옵션도 있음)

